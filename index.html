<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Camera Slider Controller</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: #f0f0f0; 
        }
        .container { 
            max-width: 500px; 
            margin: 0 auto; 
            background: white; 
            padding: 20px; 
            border-radius: 10px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
        }
        .section { 
            margin: 20px 0; 
            padding: 15px; 
            border: 1px solid #ddd; 
            border-radius: 8px; 
        }
        .section h3 { 
            margin-top: 0; 
            color: #333; 
        }
        .row { 
            display: flex; 
            align-items: center; 
            margin: 10px 0; 
            gap: 10px; 
        }
        label { 
            min-width: 80px; 
            font-weight: bold; 
        }
        input[type="number"], select { 
            width: 100px; 
            padding: 5px; 
            border: 1px solid #ccc; 
            border-radius: 4px; 
        }
        button { 
            padding: 10px 20px; 
            margin: 5px; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
            font-weight: bold; 
        }
        .btn-primary { background: #007bff; color: white; }
        .btn-success { background: #28a745; color: white; }
        .btn-danger { background: #dc3545; color: white; }
        .btn-secondary { background: #6c757d; color: white; }
        .status { 
            padding: 10px; 
            border-radius: 5px; 
            margin: 10px 0; 
            text-align: center; 
            font-weight: bold; 
        }
        .connected { background: #d4edda; color: #155724; }
        .disconnected { background: #f8d7da; color: #721c24; }
        
        /* LARGE SLIDER STYLES */
        .jog-slider { 
            width: 100%; 
            height: 50px; 
            margin: 15px 0; 
            -webkit-appearance: none; 
            appearance: none; 
            background: #ddd; 
            border-radius: 25px; 
            outline: none; 
        }
        .jog-slider::-webkit-slider-thumb { 
            -webkit-appearance: none; 
            appearance: none; 
            width: 60px; 
            height: 60px; 
            background: #007bff; 
            border-radius: 50%; 
            cursor: pointer; 
            box-shadow: 0 2px 6px rgba(0,0,0,0.3); 
        }
        .jog-slider::-moz-range-thumb { 
            width: 60px; 
            height: 60px; 
            background: #007bff; 
            border-radius: 50%; 
            cursor: pointer; 
            border: none; 
            box-shadow: 0 2px 6px rgba(0,0,0,0.3); 
        }
        .jog-controls { text-align: center; }
        .jog-speed-input { 
            width: 80px; 
            padding: 8px; 
            margin: 0 10px; 
            text-align: center; 
            font-size: 16px; 
            border: 2px solid #007bff; 
            border-radius: 5px; 
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìπ Camera Slider Controller</h1>
        
        <div id="status" class="status disconnected">‚ö° Disconnected</div>
        <button id="connectBtn" class="btn-primary" onclick="connect()">Connect BLE</button>
        
        <!-- Motor Settings -->
        <div class="section">
            <h3>üéØ Motor 1 Settings</h3>
            <div class="row">
                <label>Start:</label>
                <input type="number" id="m1Start" value="0">
                <button class="btn-secondary" onclick="setM1Start()">Set</button>
            </div>
            <div class="row">
                <label>End:</label>
                <input type="number" id="m1End" value="2000">
                <button class="btn-secondary" onclick="setM1End()">Set</button>
            </div>
            <div class="row">
                <label>Speed:</label>
                <input type="number" id="m1Speed" value="2000">
                <button class="btn-secondary" onclick="setM1Speed()">Set</button>
            </div>
        </div>

        <div class="section">
            <h3>üéØ Motor 2 Settings</h3>
            <div class="row">
                <label>Start:</label>
                <input type="number" id="m2Start" value="0">
                <button class="btn-secondary" onclick="setM2Start()">Set</button>
            </div>
            <div class="row">
                <label>End:</label>
                <input type="number" id="m2End" value="2000">
                <button class="btn-secondary" onclick="setM2End()">Set</button>
            </div>
            <div class="row">
                <label>Speed:</label>
                <input type="number" id="m2Speed" value="2000">
                <button class="btn-secondary" onclick="setM2Speed()">Set</button>
            </div>
        </div>

        <!-- Sequence Controls -->
        <div class="section">
            <h3>‚ñ∂Ô∏è Sequence Controls</h3>
            <div class="row">
                <label>Cycles:</label>
                <input type="number" id="cycles" value="0" min="0" max="5">
                <button class="btn-secondary" onclick="setCycles()">Set</button>
            </div>
            <div class="row">
                <label>Return:</label>
                <select id="returnMode">
                    <option value="1">Enabled</option>
                    <option value="0">Disabled</option>
                </select>
                <button class="btn-secondary" onclick="setReturn()">Set</button>
            </div>
            <button class="btn-success" onclick="run()">‚ñ∂Ô∏è RUN</button>
            <button class="btn-danger" onclick="stop()">‚èπÔ∏è STOP</button>
            <button class="btn-secondary" onclick="home()">üè† HOME</button>
        </div>

        <!-- Enhanced Jog Controls with Large Sliders -->
        <div class="section">
            <h3>üéÆ Manual Control</h3>
            <div class="jog-controls">
                <label>Max Jog Speed: </label>
                <input type="number" id="jogSpeedInput" class="jog-speed-input" value="50" min="0" max="100">
                <span>%</span>
            </div>
            
            <div style="margin: 20px 0;">
                <label><strong>Motor 1:</strong></label>
                <input type="range" id="jogM1" class="jog-slider" min="-100" max="100" value="0">
                <div style="text-align: center; margin: 10px 0;">
                    <span style="float: left;">‚Üê Reverse</span>
                    <span id="m1Value" style="font-weight: bold;">0%</span>
                    <span style="float: right;">Forward ‚Üí</span>
                </div>
            </div>
            
            <div style="margin: 20px 0;">
                <label><strong>Motor 2:</strong></label>
                <input type="range" id="jogM2" class="jog-slider" min="-100" max="100" value="0">
                <div style="text-align: center; margin: 10px 0;">
                    <span style="float: left;">‚Üê Reverse</span>
                    <span id="m2Value" style="font-weight: bold;">0%</span>
                    <span style="float: right;">Forward ‚Üí</span>
                </div>
            </div>
            
            <div style="margin: 20px 0;">
                <label><strong>Both Motors:</strong></label>
                <input type="range" id="jogBoth" class="jog-slider" min="-100" max="100" value="0">
                <div style="text-align: center; margin: 10px 0;">
                    <span style="float: left;">‚Üê Reverse</span>
                    <span id="bothValue" style="font-weight: bold;">0%</span>
                    <span style="float: right;">Forward ‚Üí</span>
                </div>
            </div>
        </div>
    </div>
<script>
        let device = null;
        let characteristic = null;
        
        // Update display values when sliders move
        document.getElementById('jogM1').addEventListener('input', function() {
            document.getElementById('m1Value').textContent = this.value + '%';
            sendJogCommand('M1', this.value);
        });
        
        document.getElementById('jogM2').addEventListener('input', function() {
            document.getElementById('m2Value').textContent = this.value + '%';
            sendJogCommand('M2', this.value);
        });
        
        document.getElementById('jogBoth').addEventListener('input', function() {
            document.getElementById('bothValue').textContent = this.value + '%';
            sendJogCommand('BOTH', this.value);
            // Sync individual sliders
            document.getElementById('jogM1').value = this.value;
            document.getElementById('jogM2').value = this.value;
            document.getElementById('m1Value').textContent = this.value + '%';
            document.getElementById('m2Value').textContent = this.value + '%';
        });
        
        // Reset sliders when released
        ['jogM1', 'jogM2', 'jogBoth'].forEach(id => {
            document.getElementById(id).addEventListener('mouseup', resetSlider);
            document.getElementById(id).addEventListener('touchend', resetSlider);
        });
        
        function resetSlider(event) {
            event.target.value = 0;
            if(event.target.id === 'jogM1') {
                document.getElementById('m1Value').textContent = '0%';
                sendJogCommand('M1', 0);
            } else if(event.target.id === 'jogM2') {
                document.getElementById('m2Value').textContent = '0%';
                sendJogCommand('M2', 0);
            } else if(event.target.id === 'jogBoth') {
                document.getElementById('bothValue').textContent = '0%';
                document.getElementById('jogM1').value = 0;
                document.getElementById('jogM2').value = 0;
                document.getElementById('m1Value').textContent = '0%';
                document.getElementById('m2Value').textContent = '0%';
                sendJogCommand('BOTH', 0);
            }
        }
        
        function sendJogCommand(axis, value) {
            const maxSpeed = document.getElementById('jogSpeedInput').value;
            const scaledValue = Math.round((value * maxSpeed) / 100);
            sendBLE(`JOGSLIDER:${axis}:${scaledValue}`);
        }
        
        // BLE Functions
        async function connect() {
            try {
                device = await navigator.bluetooth.requestDevice({
                    filters: [{ name: 'CameraSlider' }],
                    optionalServices: ['12345678-1234-1234-1234-1234567890ab']
                });
                
                const server = await device.gatt.connect();
                const service = await server.getPrimaryService('12345678-1234-1234-1234-1234567890ab');
                characteristic = await service.getCharacteristic('abcd1234-1234-1234-1234-abcdef123456');
                
                document.getElementById('status').textContent = '‚úÖ Connected';
                document.getElementById('status').className = 'status connected';
                document.getElementById('connectBtn').textContent = 'Disconnect';
                document.getElementById('connectBtn').onclick = disconnect;
                
            } catch(error) {
                console.error('Connection failed:', error);
                document.getElementById('status').textContent = '‚ùå Connection Failed';
            }
        }
        
        function disconnect() {
            if(device && device.gatt.connected) {
                device.gatt.disconnect();
            }
            document.getElementById('status').textContent = '‚ö° Disconnected';
            document.getElementById('status').className = 'status disconnected';
            document.getElementById('connectBtn').textContent = 'Connect BLE';
            document.getElementById('connectBtn').onclick = connect;
        }
        
        async function sendBLE(command) {
            if(characteristic) {
                try {
                    await characteristic.writeValue(new TextEncoder().encode(command));
                } catch(error) {
                    console.error('Send failed:', error);
                }
            }
        }
        
        // Motor Settings Functions
        function setM1Start() { sendBLE(`M1S:${document.getElementById('m1Start').value}`); }
        function setM1End() { sendBLE(`M1E:${document.getElementById('m1End').value}`); }
        function setM1Speed() { sendBLE(`M1SPD:${document.getElementById('m1Speed').value}`); }
        function setM2Start() { sendBLE(`M2S:${document.getElementById('m2Start').value}`); }
        function setM2End() { sendBLE(`M2E:${document.getElementById('m2End').value}`); }
        function setM2Speed() { sendBLE(`M2SPD:${document.getElementById('m2Speed').value}`); }
        function setCycles() { sendBLE(`CYCLES:${document.getElementById('cycles').value}`); }
        function setReturn() { sendBLE(`RETURN:${document.getElementById('returnMode').value}`); }
        
        // Control Functions
        function run() { sendBLE('RUN'); }
        function stop() { sendBLE('STOP'); }
        function home() { sendBLE('HOME'); }
    </script>
</body>
</html>




